---
title: "HW3-am6592"
author: "Adeena Moghni"
date: "2024-10-07"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse) #read csv
library(readxl) #read excel
library(haven) #read SAS
library(ggridges)
library(patchwork)
library(p8105.datasets)
```

## Problem 2

```{r include=FALSE}
demo_df = 
  read.csv("data_imports/nhanes_covar.csv", na = c(".", "NA", ""),
          skip = 5,
          header = FALSE, 
          col.names = c("SEQN", "sex", "age", "BMI", "education")) %>% 
  janitor::clean_names() %>% 
  mutate(
    seqn = as.character(seqn),
    sex = as.factor(sex),
    age = as.integer(age),
    bmi = as.double(bmi),
    education = as.factor(education)
    )

mims_df = 
  read.csv("data_imports/nhanes_accel.csv", na = c(".", "NA", "")) %>% 
  janitor::clean_names() %>% 
  mutate(
    seqn = as.character(seqn)
  )

full_accel_df = left_join(mims_df, demo_df, by = "seqn") %>% 
  filter(age > 21) %>% 
  na.omit(full_accel_df) %>% 
  pivot_longer(
    min1:min1440,
    names_to = "minute", 
    values_to = "MIMS",
    names_prefix = "min") %>%  
  mutate(
    minute = as.factor(minute)
  )
```

```{r echo=FALSE, message = FALSE, warning = FALSE}
education_count =
  full_accel_df %>% 
  distinct(seqn, .keep_all = TRUE) %>% 
  na.omit() %>% 
  group_by(sex, education) %>% 
   summarize(counts = n())

knitr::kable(education_count)
```

```{r echo=FALSE}
demo_plot = 
  demo_df %>% 
  filter(age > 21) %>%
  na.omit(demo_df) %>% 
  mutate(sex = ifelse(sex == 1, "Male", "Female"))

ggplot(demo_plot, aes(x = age, fill = education)) +
  geom_density(alpha = .4, adjust = .5, color = "blue") +
  facet_grid(~sex) +
  labs(title = "Distribution of Education Levels by Age",
       x = "Age", y = "density",
       fill = "Education Level") +
  scale_fill_discrete(
    labels = c("1" = "Less than High School", "2" = "High School Equivalent", "3" = "More than High School")
    )
```

```{r}
activity_plot = 
  full_accel_df %>%
  group_by(seqn, age, sex, education) %>% 
  summarize(total_activity = sum(MIMS))

ggplot(activity_plot, aes(x = age, y = total_activity, color = sex)) +
  geom_point()
```


## Problem 3
```{r include=FALSE}
jan2020_df = 
  read.csv("data_imports/citibike/Jan_2020_Citi.csv", na = c(".", "NA", ""))

jan2024_df = 
  read.csv("data_imports/citibike/Jan_2024_Citi.csv", na = c(".", "NA", ""))

july2020_df = 
  read.csv("data_imports/citibike/July_2020_Citi.csv", na = c(".", "NA", ""))

july2024_df = 
  read.csv("data_imports/citibike/July_2024_Citi.csv", na = c(".", "NA", ""))
```


